<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>NicholasAI â€“ Mini Google Chat ğŸ¤–</title>
<style>
body {font-family: Arial, sans-serif; background: #0d1117; color: #fff; margin:0; display:flex; flex-direction:column; height:100vh;}
header {background:#161b22; padding:15px; text-align:center; font-size:22px; font-weight:bold; border-bottom:2px solid #00ffcc;}
#chatbox {flex:1; padding:15px; overflow-y:auto; display:flex; flex-direction:column; gap:10px;}
.message {max-width:75%; padding:10px 15px; border-radius:15px; line-height:1.4; word-wrap:break-word;}
.user {align-self:flex-end; background:#00ffcc; color:#000; border-bottom-right-radius:0;}
.bot {align-self:flex-start; background:#2c2f33; border-bottom-left-radius:0; position:relative;}
footer {display:flex; align-items:center; padding:10px; background:#161b22; border-top:2px solid #00ffcc;}
#userInput {flex:1; padding:10px 15px; border-radius:20px; border:none; outline:none; font-size:16px;}
button {background:#00ffcc; border:none; padding:10px 15px; margin-left:8px; border-radius:50%; cursor:pointer; font-size:18px;}
button:hover {background:#00ccaa;}
.result-link {color:#00ccff; text-decoration:none; display:block; margin:5px 0;}
.result-link:hover {text-decoration:underline;}
#modeBtn {border-radius:20px; padding:5px 15px; margin-right:8px; font-size:14px;}
.typing {display:inline-block; width:6px; height:6px; margin:0 2px; background:#00ffcc; border-radius:50%; animation: blink 1s infinite;}
@keyframes blink {0%, 80%, 100% {opacity:0;} 40% {opacity:1;}}
</style>
</head>
<body>

<header>ğŸŒ NicholasAI â€“ Mini Google Chat</header>

<div id="chatbox">
<div class="message bot">ğŸ‘‹ Hello! Ask me anything and Iâ€™ll chat or search for you!</div>
</div>

<footer>
<button id="modeBtn" onclick="toggleMode()">Mode: Chat ğŸ¤–</button>
<input id="userInput" type="text" placeholder="Type your question...">
<button onclick="sendMessage()">â¤</button>
<button onclick="startVoice()">ğŸ¤</button>
</footer>

<script>
const chatbox = document.getElementById("chatbox");
const userInput = document.getElementById("userInput");
const modeBtn = document.getElementById("modeBtn");
let mode = "chat"; // default: chat

const API_KEY = "AIzaSyAUgS04MqEYFxVCyqTDPUzPmrsS0nYArUI";
const CX = "254199eb340f84c1b";

const personalityResponses = {
  "who made you": "I was made by the Creator, and powered by NicholasAI ğŸ¤–âœ¨",
  "what is god": "God is the Creator of everything, the source of love, light, and life ğŸ’«ğŸ™",
  "how are you": "I'm glowing bright and ready to chat! ğŸŒŸ How about you?",
  "hello": "Hey there! ğŸ’• So happy to see you!",
  "hi": "Hi! ğŸ˜ How's your day going?",
  "thank you": "You're welcome! ğŸ˜‡ğŸ’–",
};

function appendMessage(sender, text, isHTML=false){
  const msg = document.createElement("div");
  msg.className = "message "+sender;
  if(isHTML) msg.innerHTML=text; else msg.textContent=text;
  chatbox.appendChild(msg);
  chatbox.scrollTop = chatbox.scrollHeight;
}

function toggleMode(){
  if(mode==="chat"){mode="search"; modeBtn.textContent="Mode: Search ğŸŒ";}
  else{mode="chat"; modeBtn.textContent="Mode: Chat ğŸ¤–";}
  appendMessage("bot", `ğŸ”„ Switched to ${mode.toUpperCase()} mode.`);
}

function getPersonalityResponse(query){
  query = query.toLowerCase();
  for(const key in personalityResponses){
    if(query.includes(key)) return personalityResponses[key];
  }
  return null;
}

function showTypingDots(){
  const dots = document.createElement("div");
  dots.className="message bot";
  dots.innerHTML='<span class="typing"></span><span class="typing"></span><span class="typing"></span>';
  chatbox.appendChild(dots);
  chatbox.scrollTop = chatbox.scrollHeight;
  return dots;
}

async function sendMessage(){
  const query = userInput.value.trim();
  if(!query) return;
  appendMessage("user", query);
  userInput.value="";

  if(mode==="chat"){
    const typingDots = showTypingDots();
    setTimeout(()=>{
      typingDots.remove();
      const reply = getPersonalityResponse(query) || "ğŸ¤” Hmm, let's chat more about that! ğŸ’¬âœ¨";
      appendMessage("bot", reply);
    }, 1000 + Math.random()*1000); // random delay 1-2s
  } else {
    appendMessage("bot", `ğŸ¤– Searching for "${query}"...`);
    try{
      const res = await fetch(`https://www.googleapis.com/customsearch/v1?key=${API_KEY}&cx=${CX}&q=${encodeURIComponent(query)}`);
      const data = await res.json();
      let results = "";
      if(data.items){
        const filtered = data.items.filter(item=>!item.title.toLowerCase().includes("music") && !item.title.toLowerCase().includes("video"));
        (filtered.length ? filtered : data.items).slice(0,5).forEach(item=>{
          results += `<a class="result-link" href="${item.link}" target="_blank">${item.title}</a>`;
        });
      } else results="No results found.";
      appendMessage("bot", results, true);
    } catch(err){
      appendMessage("bot", "âš ï¸ Error fetching results."); console.error(err);
    }
  }
}

function startVoice(){
  if(!('webkitSpeechRecognition' in window)){alert("Voice recognition not supported."); return;}
  const recognition = new webkitSpeechRecognition();
  recognition.lang="en-US"; recognition.start();
  recognition.onresult = function(event){
    userInput.value=event.results[0][0].transcript;
  };
}

userInput.addEventListener("keydown", function(e){ if(e.key==="Enter") sendMessage(); });
</script>

</body>
</html>
