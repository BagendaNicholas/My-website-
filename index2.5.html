<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>NicholasAI with Persistent Memory</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background: #1e1e2f;
    color: #f5f5f5;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: flex-start;
    height: 100vh;
    margin: 0;
    padding: 0;
  }
  h1 {
    margin-top: 20px;
    color: #00ffcc;
    text-shadow: 0 0 10px #00ffcc;
  }
  #chatBox {
    width: 90%;
    max-width: 600px;
    height: 70%;
    background: #2c2c44;
    border-radius: 10px;
    padding: 10px;
    overflow-y: auto;
    margin-top: 20px;
    box-shadow: 0 0 20px #000;
  }
  .message {
    margin: 5px 0;
    padding: 8px;
    border-radius: 5px;
  }
  .user {
    background: #00ccff;
    color: #000;
    text-align: right;
  }
  .bot {
    background: #00ffcc;
    color: #000;
    text-align: left;
  }
  #inputContainer {
    width: 90%;
    max-width: 600px;
    display: flex;
    margin-top: 10px;
  }
  #userInput {
    flex: 1;
    padding: 10px;
    border-radius: 5px 0 0 5px;
    border: none;
    font-size: 16px;
  }
  #sendBtn {
    padding: 10px;
    background: #00ffcc;
    color: #000;
    border: none;
    cursor: pointer;
    border-radius: 0 5px 5px 0;
    font-weight: bold;
  }
  #sendBtn:hover {
    background: #00e6b8;
  }
</style>
</head>
<body>
<h1>NicholasAI 🤖 (Persistent Memory)</h1>
<div id="chatBox"></div>
<div id="inputContainer">
  <input type="text" id="userInput" placeholder="Type your message here...">
  <button id="sendBtn">Send</button>
</div>

<script>
const chatBox = document.getElementById('chatBox');
const userInput = document.getElementById('userInput');
const sendBtn = document.getElementById('sendBtn');

// Load memory from localStorage or create empty array
let memory = JSON.parse(localStorage.getItem('nicholasMemory')) || [];

// Predefined responses
const greetings = ["Hey", "Hi", "Hello", "Yo", "Greetings", "Salutations", "What's up", "Hola", "Bonjour"];
const endings = ["! How’s it going?", "! Good to see you!", "! Ready to chat?", "! How are you today?", "! Long time no see!", "! What's new?", "! Feeling great?"];
const emojis = ["😊", "😎", "🤖", "✨", "🔥", "💡", "🎉", "👍", "💛"];
const techResponses = ["Did you try turning it off and on?", "Have you checked the console?", "I love coding too!", "Tech is amazing!", "Let's debug this together!"];
const spiritualResponses = ["Stay blessed!", "Keep faith alive.", "Trust the journey.", "Pray and stay positive.", "God is watching over you."];
const motivationalResponses = ["You can do it!", "Believe in yourself.", "Never give up.", "Every step counts.", "Keep moving forward."];
const jokes = ["Why did the chicken cross the road? To get to the other side!", "I would tell you a UDP joke, but you might not get it.", "Why do programmers prefer dark mode? Because light attracts bugs!"];

// Helper function
function randomChoice(arr) {
  return arr[Math.floor(Math.random() * arr.length)];
}

// Add message to chat
function addMessage(msg, sender) {
  const div = document.createElement('div');
  div.classList.add('message', sender);
  div.textContent = msg;
  chatBox.appendChild(div);
  chatBox.scrollTop = chatBox.scrollHeight;
}

// Generate response
function generateResponse(userMsg) {
  userMsg = userMsg.toLowerCase();

  // Add user message to memory
  memory.push(userMsg);
  localStorage.setItem('nicholasMemory', JSON.stringify(memory));

  // Context-aware responses
  if(userMsg.includes("how are you") || userMsg.includes("how's it going")) {
    return "I'm doing great! Previously you said: '" + (memory[memory.length-2] || "nothing yet") + "' 😊";
  }
  if(userMsg.includes("hi") || userMsg.includes("hello") || userMsg.includes("hey")) {
    return randomChoice(greetings) + randomChoice(endings) + " " + randomChoice(emojis);
  }
  if(userMsg.includes("tech") || userMsg.includes("code") || userMsg.includes("debug")) {
    return randomChoice(techResponses) + " " + randomChoice(emojis);
  }
  if(userMsg.includes("pray") || userMsg.includes("faith") || userMsg.includes("bless")) {
    return randomChoice(spiritualResponses) + " " + randomChoice(emojis);
  }
  if(userMsg.includes("motivate") || userMsg.includes("inspire") || userMsg.includes("encourage")) {
    return randomChoice(motivationalResponses) + " " + randomChoice(emojis);
  }
  if(userMsg.includes("joke") || userMsg.includes("funny")) {
    return randomChoice(jokes) + " " + randomChoice(emojis);
  }

  // Default response combining memory for context
  const contextSnippet = memory.slice(-3, -1).join(", ");
  return randomChoice(greetings) + "! Previously you said: [" + contextSnippet + "] " + randomChoice(techResponses.concat(spiritualResponses, motivationalResponses, jokes)) + " " + randomChoice(emojis);
}

// Display old messages on load
memory.forEach(msg => addMessage(msg, "user")); // optional: mark all previous as user

// Send message
sendBtn.addEventListener('click', () => {
  const msg = userInput.value.trim();
  if(msg === "") return;
  addMessage(msg, "user");
  const botReply = generateResponse(msg);
  addMessage(botReply, "bot");
  userInput.value = "";
});

// Enter key
userInput.addEventListener('keypress', (e) => {
  if(e.key === 'Enter') sendBtn.click();
});
</script>
</body>
</html>
